<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=1024, user-scalable=no">

	<title>Introduction to Knockout.js</title>
	
	<!-- Required stylesheet -->
	<link rel="stylesheet" href="core/deck.core.css">
	
	<!-- Extension CSS files go here. Remove or add as needed. -->
	<link rel="stylesheet" href="extensions/goto/deck.goto.css">
	<link rel="stylesheet" href="extensions/menu/deck.menu.css">
	<link rel="stylesheet" href="extensions/navigation/deck.navigation.css">
	<link rel="stylesheet" href="extensions/status/deck.status.css">
	<link rel="stylesheet" href="extensions/hash/deck.hash.css">
	<link rel="stylesheet" href="extensions/scale/deck.scale.css">
	<link rel="stylesheet" href="extensions/codemirror/deck.codemirror.css">

	<!-- Style theme. More available in /themes/style/ or create your own. -->
	<link rel="stylesheet" href="themes/style/swiss.css">
	<link rel="stylesheet" href="themes/style/presentation.css">
	
	<!-- Transition theme. More available in /themes/transition/ or create your own. -->
	<link rel="stylesheet" href="themes/transition/horizontal-slide.css">
	
	<!-- Required Modernizr file -->
	<script src="modernizr.custom.js"></script>
	<script src="jquery-1.7.2.min.js"></script>
	<script src="knockout-2.1.0.js"></script>
	
</head>
<body class="deck-container">

<!-- Begin slides. Just make elements with a class of slide. -->

<section class="slide">
	<h2>Knockout.js</h2>
	<strong><p>For building dynamic JavaScript UI with MVVM</p></strong>
	<p>Arild Nilsen, September 2012</p>
</section>

<section class="slide">
	<h2>Key points</h2>
	<p>Open source JavaScript library (MIT license)
	<p>2 years old. Active community</p>
	<p>Focuses on dynamic UI</p>
</section>

<section class="slide">
	<h2>Model View ViewModel</h2>
	<img alt="" src="mvvm.png">
	<div class="slide">
	<h4>View</h4>
	<ul>
		<li>Interactive UI that represent the state of a ViewModel</li>
		<li>View in Knockout.js = HTML + declarative bindings</li>
	</ul>
	</div>
	<div class="slide">
	<h4>ViewModel</h4>
	<ul>
		<li>Transform data and mediate commands</li>
		<li>ViewModel in Knockout.js = JavaScript objects with no knowledge of HTML</li>
	</ul>
	</div>
	<div class="slide">
	<h4>Model</h4>
	<ul>
		<li>Represents domain specific data</li>
		<li>Does not influence how data appears</li>
	</ul>
	</div>
</section>

<section class="slide">
	<h2>Data bindings without Knockout</h2>
	<div id="content">	
		<div id="left">
			HTML
			<div id="html_code">
			</div>	
			<br>
			JavaScript
			<div id="js_code">
			</div>
		</div>
		<div id="right">
			Result
			<iframe scrolling="no" src="example_1.html"></iframe>
		</div>
	</div>
</section>


<section class="slide">
	<h2>Knockout <tt>observables</tt></h2>
	<div id="content">	
		<div id="left">
			HTML
			<div id="html_code">
			</div>	
			<br>
			JavaScript
			<div id="js_code">
			</div>
		</div>
		<div id="right">
			Result
			<iframe scrolling="no" src="example_2.html"></iframe>
		</div>
	</div>
</section>

<section class="slide">
	<h2><tt>observables</tt> - alternative syntax</h2>
	<div id="content">	
		<div id="left">
			HTML
			<div id="html_code">
			</div>	
			<br>
			JavaScript
			<div id="js_code">
			</div>
		</div>
		<div id="right">
			Result
			<iframe scrolling="no" src="example_3.html"></iframe>
		</div>
	</div>
</section>

<section class="slide">
	<h2>Knockout <tt>foreach</tt></h2>
	<div id="content">	
		<div id="left">
			HTML
			<div id="html_code">
			</div>	
			<br>
			JavaScript
			<div id="js_code">
			</div>
		</div>
		<div id="right">
			Result
			<iframe scrolling="no" src="example_4.html"></iframe>
		</div>
	</div>
</section>

<section class="slide">
	<h2>Knockout <tt>observable arrays</tt></h2>
	<div id="content">	
		<div id="left">
			HTML
			<div id="html_code">
			</div>	
			<br>
			JavaScript
			<div id="js_code">
			</div>
		</div>
		<div id="right">
			Result
			<iframe scrolling="no" src="example_5.html"></iframe>
		</div>
	</div>
</section>

<section class="slide">
	<h2>Knockout <tt>observable arrays</tt></h2>
	<div id="content">	
		<div id="left">
			HTML
			<div id="html_code">
			</div>	
			<br>
			JavaScript
			<div id="js_code">
			</div>
		</div>
		<div id="right">
			Result
			<iframe scrolling="no" src="example_5.1.html"></iframe>
		</div>
	</div>
</section>

<section class="slide">
<h2>Benefits</h2>

<p class="slide">Does one thing well: rich UIs</p>
<p class="slide">Extensive documentation. Interactive examples.</p>
</section>

<section class="slide">
<h2>Challenges</h2>
<p class="slide">Guidelines for structuring ViewModel?</p>
<p class="slide">Performance. Dependency resolving.</p>
<p class="slide">Difficult to debug</p>
<p class="slide">Logic in views</p>
<p class="slide">Overkill for smaller applications</p>
</section>


<!-- End slides. -->


<!-- Begin extension snippets. Add or remove as needed. -->

<!-- deck.navigation snippet -->
<a href="#" class="deck-prev-link" title="Previous">&#8592;</a>
<a href="#" class="deck-next-link" title="Next">&#8594;</a>

<!-- deck.status snippet -->
<p class="deck-status">
	<span class="deck-status-current"></span>
	/
	<span class="deck-status-total"></span>
</p>

<!-- deck.goto snippet -->
<form action="." method="get" class="goto-form">
	<label for="goto-slide">Go to slide:</label>
	<input type="text" name="slidenum" id="goto-slide" list="goto-datalist">
	<datalist id="goto-datalist"></datalist>
	<input type="submit" value="Go">
</form>

<!-- deck.hash snippet -->
<a href="." title="Permalink to this slide" class="deck-permalink">#</a>

<!-- End extension snippets. -->


<!-- Required JS files. -->
<script src="core/deck.core.js"></script>

<!-- Extension JS files. Add or remove as needed. -->
<script src="core/deck.core.js"></script>
<script src="extensions/hash/deck.hash.js"></script>
<script src="extensions/menu/deck.menu.js"></script>
<script src="extensions/goto/deck.goto.js"></script>
<script src="extensions/status/deck.status.js"></script>
<script src="extensions/navigation/deck.navigation.js"></script>
<script src="extensions/scale/deck.scale.js"></script>

<!-- Base codemiror code -->
<script src="extensions/codemirror/codemirror.js"></script>

<!-- Syntax highlighting Modes -->

<!-- javascript -->
<script src="extensions/codemirror/mode/javascript/javascript.js"></script>

<!-- html mode (note html mode requires xml, css and javascript) -->
<script src="extensions/codemirror/mode/xml/xml.js"></script>
<script src="extensions/codemirror/mode/css/css.js"></script>
<script src="extensions/codemirror/mode/htmlmixed/htmlmixed.js"></script>

<link rel="stylesheet" href="extensions/codemirror/themes/default.css">

<!-- Plugin code -->
<script src="extensions/codemirror/deck.codemirror.js"></script>

<!-- Initialize the deck. You can put this in an external file if desired. -->
	
<script>
	$(function() {
		$.deck('.slide');
		$(document).keydown(function(e){
			if (e.ctrlKey && e.which == 13) {
				var slide = $.deck('getSlide');
				if (has_js_example(slide)) {
					render_iframe_html(slide); // Update iframe html before running js
					eval_js_example(slide);
				}
		    }
		});
	});

	var code_mirrors_js = [];
	var code_mirrors_html = [];
	var js_examples = [];
	
	function has_js_example(slide) {
		if ($('iframe', slide).length == 0)
			return false;
		return true;
	}
	
	function get_js_example(slide) {
		var iframe = $('iframe', slide).get(0).contentWindow.document;
		return $('#js_code', iframe).text();
	}
	
	function has_html_example(slide) {
		if ($('#html_code', slide).length == 0)
			return false;
		return true;
	}
	
	function get_html_example(slide) {
		var iframe = $('iframe', slide).get(0).contentWindow.document;
		return $('#html', iframe).html();
	}
	
	function set_html_example(slide, html) {
		var iframe = $('iframe', slide).get(0).contentWindow.document;
		$('#html', iframe).html(html);
	}
	
	function eval_js_example(slide) {
		var code_mirror = code_mirrors_js[slide.index()];
		var js_str = code_mirror.getValue();
		var iframe = $('iframe', slide).get(0).contentWindow.document;
		$('iframe', slide).get(0).contentWindow.eval(js_str);
		slide.focus();
	}

	// Updates the ifram's html, which is rendered automatically
	function render_iframe_html(slide) {
		var code_mirror = code_mirrors_html[slide.index()];
		var html = code_mirror.getValue();
		set_html_example(slide, html);
	}

	// Copy iframe html to result html
	function render_result_html(slide) {
		var iframe = $('iframe', slide).get(0).contentWindow.document;
		$('#html', iframe).clone().appendTo($('body'));
	}
	
	$(document).bind('deck.change', function(event, from, to) {
		var slide = $.deck('getSlide', to);
		
		if (has_js_example(slide)) {
			if ($('.CodeMirror', slide).length == 0) {
				// HTML code mirror
				var html_str = get_html_example(slide);
				//console.log('HTML: ' + html_str)
				var textarea = $('#html_code', slide);
				var code_mirror_html = CodeMirror.fromTextArea(textarea.get(0), {
					mode:  "htmlmixed",
					autoClearEmptyLines: true,
					indentUnit: 4,
					indentWithTabs: true
				});
				code_mirror_html.setValue(html_str);				
				code_mirrors_html[slide.index()] = code_mirror_html;
				textarea.bind('change', function() {
					render_html(slide);
				});
				
				// JS code mirror
				var js_str = get_js_example(slide);
				//console.log('JS STR: ' + js_str);
				var textarea = $('#js_code', slide);
				var code_mirror_js = CodeMirror.fromTextArea(textarea.get(0), {
					mode:  "javascript",
					autoClearEmptyLines: true,
					indentUnit: 4,
					indentWithTabs: true
				});
				code_mirror_js.setValue(js_str);
				code_mirrors_js[slide.index()] = code_mirror_js;
				textarea.bind('change', function() {
					eval_js_example(slide);
				});
			}
			render_iframe_html(slide);
		}			
	});
</script>

</body>
</html>
